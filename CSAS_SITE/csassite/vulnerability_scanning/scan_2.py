import json
import time

class vulnerab(object):
    def __init__(self):
        self.name = ''
        self.url = ''
        self.vuln_id = ''
        self.cvecode = ''

class exploit_info(object):
    def __init__(self):
        self.exploit = ''
        self.payload = ''
        self.description = ''


def store_vulner(filename = "static/vuln.json"):
    allvulners = []
    vuln_count=0
    with open(filename) as f:
        vuln_list = json.load(f)
    for vuln_dict in vuln_list:
        if vuln_dict['severity'] == 3:
            new_vuln = vulnerab()
            new_vuln.name = vuln_dict['vt_name']
            new_vuln.url = vuln_dict['affects_url']
            new_vuln.vuln_id = vuln_dict['vuln_id']
            allvulners.append(new_vuln)
            vuln_count = vuln_count+1
    return allvulners


def vulner_grade_num(filename = "static/vuln.json"):
    high_num = 0
    medium_num = 0
    low_num = 0
    grade_list = []
    with open(filename) as f:
        vuln_list = json.load(f)
    for vuln_dict in vuln_list:
        if vuln_dict['severity'] == 3:
            high_num = high_num +1
        elif vuln_dict['severity'] == 2:
            medium_num = medium_num + 1
        elif vuln_dict['severity'] == 1:
            low_num = low_num + 1
        else:
            pass
    grade_list.append(high_num)
    grade_list.append(medium_num)
    grade_list.append(low_num)
    return grade_list


def found_exploit(filename = "static/module.json"):
    result_list = []
    with open(filename) as f:
        exploit_list = json.load(f)
    for exploit_dict in exploit_list:
        new_exploit = exploit_info()
        new_exploit.exploit = exploit_dict["exploit"]
        new_exploit.payload = exploit_dict["payload"]
        new_exploit.description = exploit_dict["description"]
        result_list.append(new_exploit)
    return result_list

